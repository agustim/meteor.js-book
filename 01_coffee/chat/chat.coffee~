Messages = new Meteor.Collection('messages');

if Meteor.isClient 
  Template.content.title = -> "Welcome to chat."

  Template.content.events(
    'click input#button' : ->
      my_name = $('#name').val();
      my_mess = $('#message').val();
      if (my_name != "") and (my_mess != "") 
        my_date = Date.now();
        Messages.insert(
           name: my_name, 
           text: my_mess, 
           time: my_date
        );
        my_name.val("");
        my_mess.val("");
      
  );

  Template.content.messages = -> Messages.find({}, { sort: {time: -1} })


if Meteor.isServer 
  Meteor.startup( -> );

